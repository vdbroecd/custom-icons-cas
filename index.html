<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Icon Library</title>
    <style>
        body { font-family: Arial, sans-serif; background-color: rgb(28, 28, 28); color: white; text-align: center; }
        .search-bar { width: 300px; padding: 10px; margin-bottom: 20px; }

        /* Grid container to display groups */
        .group-container { 
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); /* Grid will adjust dynamically */
            gap: 20px; 
            padding: 20px;
        }

        /* Group container for each category */
        .group {
            background: rgb(48, 48, 48);
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        }

        .group h2 {
            font-size: 16px;
            margin-bottom: 10px;
        }

        .icon-grid { 
            display: flex; 
            flex-wrap: wrap; 
            gap: 10px; 
            justify-content: center; 
        }

        .icon-item {
            display: flex;
            flex-direction: column; /* Zorgt ervoor dat de naam onder de afbeelding komt */
            align-items: center; /* Centraal uitlijnen */
            justify-content: center;
            text-align: center;
        }

        .icon-item img {
            width: 64px; 
            height: 64px;
            padding: 10px;
            background-color: rgb(48, 48, 48); /* Achtergrondkleur */
            border-radius: 5px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.4);
        }

        .icon-item p {
            font-size: 12px;
            word-break: break-all;
            width: 80px;
            margin-top: 5px; /* Ruimte tussen het icoon en de naam */
        }

        /* Customizable styles for large and small groups */
        .group.large {
            grid-column: span 2; /* Large groups span across 2 columns */
        }

        .group.small {
            grid-column: span 1; /* Small groups stay within 1 column */
        }

        /* Popup styling */
        .popup {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }
        .popup-content {
            background: rgb(48, 48, 48);
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            color: white;
        }
        .popup img {
            width: 150px;
            height: 150px;
        }
        .popup button {
            margin-top: 10px;
            padding: 10px;
            background-color: #007BFF;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        .popup button:hover {
            background-color: #0056b3;
        }
    </style>
</head>
<body>
    <h1>Icon Library</h1>
    <input type="text" id="searchInput" class="search-bar" placeholder="Zoek iconen..." onkeyup="searchIcons()">
    
    <div class="group-container" id="groupContainer"></div>

    <!-- Popup Modal for Icon -->
    <div class="popup" id="popup">
        <div class="popup-content">
            <img id="popupImage" src="" alt="Popup Icon">
            <p id="popupText"></p>
            <p id="popupHex"></p> <!-- Hex color code will appear here -->
            <button id="downloadBtn">Download</button>
            <button onclick="closePopup()">Close</button>
            <button id="copyHexBtn">Copy Hex Code</button> <!-- Copy hex code button -->
        </div>
    </div>

    <script>
        const iconBasePath = "icons"; // De map waar iconen staan

        async function loadIcons() {
            try {
                let response = await fetch(`https://api.github.com/repos/vdbroecd/custom-icons-cas/contents/${iconBasePath}`);
                let files = await response.json();

                let groupedIcons = {};

                // Groep iconen op basis van bestandsnaam
                files.forEach(file => {
                    if (file.name.endsWith(".svg")) {
                        let parts = file.name.replace("icon_", "").split(" ");
                        let groupName = parts[0]; // Groep gebaseerd op het eerste woord na "icon_"

                        if (!groupedIcons[groupName]) {
                            groupedIcons[groupName] = [];
                        }
                        groupedIcons[groupName].push(file.name);
                    }
                });

                let container = document.getElementById("groupContainer");
                container.innerHTML = "";

                Object.keys(groupedIcons).forEach(group => {
                    let groupDiv = document.createElement("div");
                    groupDiv.classList.add("group");

                    if (groupedIcons[group].length > 5) {
                        groupDiv.classList.add("large");
                    } else {
                        groupDiv.classList.add("small");
                    }

                    let title = document.createElement("h2");
                    title.textContent = group;
                    groupDiv.appendChild(title);

                    let iconGrid = document.createElement("div");
                    iconGrid.classList.add("icon-grid");

                    // Sorteer de iconen zodat de 64-iconen bovenaan komen
                    let sortedIcons = groupedIcons[group].sort((a, b) => {
                        let a64 = a.includes("64");
                        let b64 = b.includes("64");
                        return (b64 - a64); // Zorg ervoor dat de 64 iconen bovenaan komen
                    });

                    sortedIcons.forEach(iconName => {
                        let iconPath = `https://vdbroecd.github.io/custom-icons-cas/${iconBasePath}/${iconName}`;
                        let iconItem = document.createElement("div");
                        iconItem.classList.add("icon-item");

                        let bgColor = "rgb(48, 48, 48)"; // Standaard achtergrond

                        // Controleer of het icoon een "64" bevat en een hex-kleur heeft
                        let match = iconName.match(/64 ([A-Fa-f0-9]{6})/);
                        if (match) {
                            bgColor = `#${match[1]}`; // Hex-code als achtergrond
                        }

                        // Voeg inline achtergrondkleur toe voor de 64-iconen
                        iconItem.innerHTML = `
                            <img src="${iconPath}" alt="${iconName}" title="${iconName}" 
                                onclick="openPopup('${iconPath}', '${iconName}', '${bgColor}')"
                                style="background-color: ${bgColor}; border-radius: 5px; padding: 10px; box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.1);">
                            <p>${iconName}</p>
                        `;
                        iconGrid.appendChild(iconItem);
                    });

                    groupDiv.appendChild(iconGrid);
                    container.appendChild(groupDiv);
                });
            } catch (error) {
                console.error("Fout bij laden van iconen:", error);
            }
        }

        // Open de popup voor het geselecteerde icoon
        function openPopup(imagePath, iconName, hexColor) {
            document.getElementById("popupImage").src = imagePath;
            document.getElementById("popupText").textContent = iconName;
            document.getElementById("popupHex").textContent = `Hex Color: ${hexColor}`;
            document.getElementById("popup").style.display = "flex";

            // Set the download link for the icon
            document.getElementById("downloadBtn").onclick = function() {
                const link = document.createElement("a");
                link.href = imagePath;
                link.download = iconName;
                link.click();
            };

            // Set the hex color to be copied
            document.getElementById("copyHexBtn").onclick = function() {
                navigator.clipboard.writeText(hexColor).then(() => {
                    alert("Hex code copied to clipboard!");
                }).catch(err => {
                    console.error('Error copying hex code: ', err);
                });
            };
        }

        // Sluit de popup
        function closePopup() {
            document.getElementById("popup").style.display = "none";
        }

        loadIcons();
    </script>
</body>
</html>
